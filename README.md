<h1>üëæüíª‚ò†Ô∏è Malware Hunting With IOCs Via Redline</h1>

<h2>Description:</h2>

- <b>Generating Indicators Of Compromise Files (IOC) Via Mandiant IOC Editor</b> 
- <b>Retrieving Parameters For IOC Files Based On System Image Samples (SHA1, SHA256, MD5 Hashes And File Properties) </b>
- <b>Scanning Target Directory For Malware Hits Via Redline Software</b> <br />

<h2>Languages and Utilities Used:</h2>

- <b>Mandiant IOC Editor v2.2.0.0</b> 
- <b>FireEye Redline v2.0</b>
- <b>Windows Powershell v1.0</b>
- <b>Security Blue Team Malware Hunt Activity Files</b>

<h2>Environments Used: </h2>

- <b>Windows 10</b> (22H2)

<h2>Activity Background:</h2>
Note: The activity files contain actual malware that will be used to simulate a real malware hunt investigation<br/>
<br/>
In this activity, I am given a system image, which must be loaded as a virtual machine, I have to utilize techniques to <br/>
generate IOCs from two malware samples, and then search the system to find all other copies of the malware hidden inside. <br/>

<h2>Activity Scenario And Files</h2>
<p align="center">
<img src="https://i.imgur.com/rj9mSIt.png" height="80%" width="80%" /><br/>
  
<p align="center">
Threat Intel Team Note: <br/>
<img src="https://i.imgur.com/Cbq2wr6.png" height="80%" width="80%" />

<p align="center">
Remote System We Will Be Investigating (DaveS): <br/>  
<img src="https://i.imgur.com/Dxe83lj.png" height="80%" width="80%" />

<p align="center">
Sample Malware File To Hunt For: <br/>  
<img src="https://i.imgur.com/fExohlM.png" height="80%" width="80%" />

<h2>Activity walk-through:</h2>

<p align="center">
<b>Create IOC file For 2 Malware File Samples Based Follow On Following Parameters:</b>  <br/>
 1. File Properties (File Name and File Size) <br/>
 2. File Hash Values (SHA1, SHA256 and MD5) <br/>
 3. String Values Provided By Team (390808010001Z0U1 , #H3XGROUPWASHERE) <br/>
<br />

<p align="center">
<b>Generate Sample Malware Files Hash Values Using Powershell</b>  <br/>
 1. cd to sample file locations <br/>
 2. Run command "Get-FileHash -Path "[FileName]" -Algorithm [SHA1/SHA256/MD5]" <br/>
 <img src="https://i.imgur.com/L1MxokM.png" height="80%" width="80%" /><br/>
 <img src="https://i.imgur.com/7ip8DT9.png" height="80%" width="80%" /><br/>

<p align="center">
<b>IOC File Parameters Should Look This:</b><br/>
<img src="https://i.imgur.com/OE5BaUb.png" height="80%" width="80%" /><br/>

<p align="center">
<b>Create IOC Collector File</b><br/>
 1. Launch Redline <br/>
 2. Create an IOC Search collector <br/>
 3. Select our newly created IOC file <br/>
 <img src="https://i.imgur.com/hh4F0WU.png" height="80%" width="80%" /><br/>

<p align="center">
 4. Edit the script and select the path to where the system (DaveS) is located if not the script will scan our host computer which will take too long <br/>  
 [Note: File path of system DaveS has been moved closer to C:/ as Redline will have trouble running audits on long file paths]
 <img src="https://i.imgur.com/ZFv7VJB.png" height="80%" width="80%" /><br/>
 
<p align="center">
 5. Create a new empty folder and save the IOC collector <br/>  
 <img src="https://i.imgur.com/BCRTd2w.png" height="80%" width="80%" /><br/>
 <img src="https://i.imgur.com/KUFC5q2.png" height="80%" width="80%" /><br/>

<p align="center">
<b>Running Redline Audit Via Command Prompt</b>  <br/>
 1. Launch Administrator Command Prompt <br/>
 2. Navigate to the saved collector folder <br/>
 3. Run Redline audit via .\RunRedlineAudit.bat command <br/>
 <img src="https://i.imgur.com/Z1f4p9H.png" height="80%" width="80%" /><br/>

 <p align="center">
 4. In the collector file, there will be a new .mans file created under Sessions <br/>  
 <img src="https://i.imgur.com/lGNqZXY.png" height="80%" width="80%" /><br/>

<p align="center">
<b>Analysing Generated .mans file in Redline</b>  <br/>
 1. Launch Redline <br/>
 2. Open A Previous Analysis and select the .mans file <br/>
 3. Select [I want to search my data with a set of indicators of compromise] <br/>
 4. Hit Report Generator based on IOC parameters <br/>
 [3 Hits has been found in DaveS's system] <br/>
 <img src="https://i.imgur.com/KPjDQ70.png" height="80%" width="80%" /><br/>

 <img src="https://i.imgur.com/9SkqBqV.png" height="80%" width="80%" />
 



  
<br />


</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
